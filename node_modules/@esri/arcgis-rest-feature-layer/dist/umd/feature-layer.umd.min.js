/* @preserve
* @esri/arcgis-rest-feature-layer - v3.4.3 - Apache-2.0
* Copyright (c) 2017-2021 Esri, Inc.
* Fri Oct 29 2021 14:49:27 GMT-0600 (Mountain Daylight Time)
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@esri/arcgis-rest-request")):"function"==typeof define&&define.amd?define(["exports","@esri/arcgis-rest-request"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).arcgisRest=e.arcgisRest||{},e.arcgisRest)}(this,function(e,a){"use strict";var s=function(){return(s=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};var r=new RegExp(/.+(?:map|feature|image)server/i);function n(e){var t=e.match(r);return t?t[0]:function(e){e=e.split("?")[0];return a.cleanUrl(e)}(e)}function u(e){return a.request(a.cleanUrl(e.url),e)}e.addAttachment=function(e){var t=s({params:{}},e);return t.params.attachment=e.attachment,a.request(a.cleanUrl(t.url)+"/"+t.featureId+"/addAttachment",t)},e.addFeatures=function(e){var t=a.cleanUrl(e.url)+"/addFeatures",e=a.appendCustomParams(e,["features","gdbVersion","returnEditMoment","rollbackOnFailure"],{params:s({},e.params)});return a.request(t,e)},e.applyEdits=function(e){var t=a.cleanUrl(e.url)+"/applyEdits",e=a.appendCustomParams(e,["adds","updates","deletes","useGlobalIds","attachments","gdbVersion","returnEditMoment","rollbackOnFailure","trueCurveClient"],{params:s({},e.params)});return a.request(t,e)},e.decodeValues=function(t){var e=t.fields?Promise.resolve(t.fields):u({url:t.url}).then(function(e){return e.fields});return e.then(function(e){var u=e.reduce(function(e,t){var r=t.domain;return r&&"codedValue"===r.type&&(e[t.name]=r),e},{});if(Object.keys(u).length<1)return t.queryResponse;e=t.queryResponse.features.map(function(e){var t,r,a,n={};for(t in e.attributes)Object.prototype.hasOwnProperty.call(e.attributes,t)&&(r=e.attributes[t],a=u[t],n[t]=null!==r&&a?function(t,e){e=e.codedValues.find(function(e){return t===e.code});return e?e.name:t}(r,a):r);return s(s({},e),{attributes:n})});return s(s({},t.queryResponse),{features:e})})},e.deleteAttachments=function(e){var t=s({params:{}},e);return t.params.attachmentIds=e.attachmentIds,a.request(a.cleanUrl(t.url)+"/"+t.featureId+"/deleteAttachments",t)},e.deleteFeatures=function(e){var t=a.cleanUrl(e.url)+"/deleteFeatures",e=a.appendCustomParams(e,["where","objectIds","gdbVersion","returnEditMoment","rollbackOnFailure"],{params:s({},e.params)});return a.request(t,e)},e.getAllLayersAndTables=function(e){var t=e.url,e=function(e,t){var r={};for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}(e,["url"]),t=n(t)+"/layers";return a.request(t,e)},e.getAttachments=function(e){return e=s({httpMethod:"GET"},e),a.request(a.cleanUrl(e.url)+"/"+e.featureId+"/attachments",e)},e.getFeature=function(e){var t=a.cleanUrl(e.url)+"/"+e.id,r=s({httpMethod:"GET"},e);return a.request(t,r).then(function(e){return r.rawResponse?e:e.feature})},e.getLayer=u,e.getService=function(e){return a.request(a.cleanUrl(e.url),e)},e.parseServiceUrl=n,e.queryFeatures=function(e){var t=a.appendCustomParams(e,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"],{httpMethod:"GET",params:s({where:"1=1",outFields:"*"},e.params)});return a.request(a.cleanUrl(e.url)+"/query",t)},e.queryRelated=function(e){var t=a.appendCustomParams(e,["objectIds","relationshipId","definitionExpression","outFields"],{httpMethod:"GET",params:s({definitionExpression:"1=1",outFields:"*",relationshipId:0},e.params)});return a.request(a.cleanUrl(e.url)+"/queryRelatedRecords",t)},e.updateAttachment=function(e){var t=s({params:{}},e);return t.params.attachment=e.attachment,t.params.attachmentId=e.attachmentId,a.request(a.cleanUrl(t.url)+"/"+t.featureId+"/updateAttachment",t)},e.updateFeatures=function(e){var t=a.cleanUrl(e.url)+"/updateFeatures",e=a.appendCustomParams(e,["features","gdbVersion","returnEditMoment","rollbackOnFailure","trueCurveClient"],{params:s({},e.params)});return a.request(t,e)},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=feature-layer.umd.min.js.map
